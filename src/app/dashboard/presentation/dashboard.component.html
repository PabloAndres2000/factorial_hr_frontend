<div class="dashboard-container">
  <!-- Navbar -->
  <nav class="navbar">
    <div class="navbar-content">
      <!-- Logo/Brand -->
      <div class="navbar-brand">
        <div class="brand-icon">
          <svg
            width="32"
            height="32"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
            <line x1="9" y1="9" x2="15" y2="9"></line>
            <line x1="9" y1="15" x2="15" y2="15"></line>
          </svg>
        </div>
        <span class="brand-text">PayrollHub</span>
      </div>

      <!-- Search Bar -->
      <div class="navbar-search">
        <svg
          class="search-icon"
          width="18"
          height="18"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.35-4.35"></path>
        </svg>
        <app-input
          type="text"
          placeholder="Buscar empleados, n√≥minas..."
          [control]="searchControl"
          variant="dashboard"
        />
      </div>

      <!-- Right Actions -->
      <div class="navbar-actions">
        <!-- Notifications -->
        <button class="action-btn" (click)="toggleNotifications()">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
            <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
          </svg>
          <span class="notification-badge" *ngIf="notificationCount > 0">{{
            notificationCount
          }}</span>
        </button>

        <!-- Settings -->
        <button class="action-btn" (click)="openSettings()">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <circle cx="12" cy="12" r="3"></circle>
            <path
              d="M12 1v6m0 6v6m5.2-13.2l-4.2 4.2m-2 2l-4.2 4.2M23 12h-6m-6 0H1m18.2 5.2l-4.2-4.2m-2-2l-4.2-4.2"
            ></path>
          </svg>
        </button>

        <!-- User Avatar with Dropdown -->
        <app-dropdown-menu
          [isOpen]="isUserMenuOpen"
          [variant]="'dashboard'"
          [header]="{ title: userName, subtitle: userEmail, avatarUrl: userAvatar }"
          [items]="userMenuItems"
          (toggle)="isUserMenuOpen = $event"
        ></app-dropdown-menu>
      </div>
    </div>
  </nav>

  <!-- Header -->
  <header class="dashboard-header">
    <div class="header-content">
      <div>
        <h1 class="dashboard-title">Dashboard</h1>
        <p class="dashboard-subtitle">{{ currentMonth }} Overview</p>
      </div>
      <button class="refresh-btn" (click)="refreshData()" [disabled]="loading">
        <span class="refresh-icon" [class.spinning]="loading">‚ü≥</span>
        Refresh
      </button>
    </div>
  </header>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <div class="spinner"></div>
    <p>Loading dashboard data...</p>
  </div>

  <!-- Main Content -->
  <div *ngIf="!loading" class="dashboard-content">
    <!-- Primary Stats Grid -->
    <div class="stats-grid primary-stats">
      <!-- Active Employees -->
      <div class="stat-card primary-card">
        <div class="stat-icon active">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
            <circle cx="9" cy="7" r="4"></circle>
            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
          </svg>
        </div>
        <div class="stat-content">
          <p class="stat-label">Active Employees</p>
          <h2 class="stat-value">{{ stats.activeEmployees }}</h2>
          <p class="stat-change positive">+5.2% from last month</p>
        </div>
      </div>

      <!-- Inactive Employees -->
      <div class="stat-card warning-card">
        <div class="stat-icon inactive">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
            <circle cx="9" cy="7" r="4"></circle>
            <line x1="17" y1="8" x2="23" y2="14"></line>
            <line x1="23" y1="8" x2="17" y2="14"></line>
          </svg>
        </div>
        <div class="stat-content">
          <p class="stat-label">Inactive Employees</p>
          <h2 class="stat-value">{{ stats.inactiveEmployees }}</h2>
          <p class="stat-change neutral">Current month</p>
        </div>
      </div>

      <!-- Paid Settlements -->
      <div class="stat-card success-card">
        <div class="stat-icon settlement">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
          </svg>
        </div>
        <div class="stat-content">
          <p class="stat-label">Paid Settlements</p>
          <h2 class="stat-value">{{ stats.paidSettlements }}</h2>
          <p class="stat-change positive">+12.8% from last month</p>
        </div>
      </div>

      <!-- Pending Approvals -->
      <div class="stat-card info-card">
        <div class="stat-icon pending">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <circle cx="12" cy="12" r="10"></circle>
            <polyline points="12 6 12 12 16 14"></polyline>
          </svg>
        </div>
        <div class="stat-content">
          <p class="stat-label">Pending Approvals</p>
          <h2 class="stat-value">{{ stats.pendingApprovals }}</h2>
          <p class="stat-change neutral">Requires attention</p>
        </div>
      </div>
    </div>

    <!-- Secondary Stats Grid -->
    <div class="stats-grid secondary-stats">
      <!-- Attendance Rate -->
      <div class="stat-card compact-card">
        <div class="compact-header">
          <span class="compact-icon">üìä</span>
          <p class="compact-label">Today's Attendance</p>
        </div>
        <h3 class="compact-value">{{ stats.attendanceRate }}%</h3>
        <div class="progress-bar">
          <div class="progress-fill" [style.width.%]="stats.attendanceRate"></div>
        </div>
      </div>

      <!-- Upcoming Shifts -->
      <div class="stat-card compact-card">
        <div class="compact-header">
          <span class="compact-icon">üìÖ</span>
          <p class="compact-label">Upcoming Shifts</p>
        </div>
        <h3 class="compact-value">{{ stats.upcomingShifts }}</h3>
        <p class="compact-subtitle">Next 7 days</p>
      </div>

      <!-- Average Hours -->
      <div class="stat-card compact-card">
        <div class="compact-header">
          <span class="compact-icon">‚è±Ô∏è</span>
          <p class="compact-label">Avg. Hours Worked</p>
        </div>
        <h3 class="compact-value">{{ stats.avgHoursWorked }}h</h3>
        <p class="compact-subtitle">Per employee/week</p>
      </div>
    </div>

    <!-- Recent Activity -->
    <div class="activity-section">
      <div class="section-header">
        <h3 class="section-title">Recent Activity</h3>
        <a href="#" class="view-all-link">View all ‚Üí</a>
      </div>
      <div class="activity-list">
        <div *ngFor="let activity of recentActivities" class="activity-item">
          <div class="activity-icon">{{ getTypeIcon(activity.type) }}</div>
          <div class="activity-details">
            <p class="activity-employee">{{ activity.employee }}</p>
            <p class="activity-action">{{ activity.action }}</p>
          </div>
          <div class="activity-meta">
            <span class="activity-time">{{ activity.time }}</span>
            <span class="activity-status" [ngClass]="getStatusClass(activity.status)">
              {{ activity.status }}
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
